# Assumptions - Lumixa Manufacturing System (LMS)

Этот документ фиксирует все допущения, принятые при разработке.

## Технические допущения

### 1. Стек технологий
- **PHP 8.2+** без обязательного Composer на сервере
- Свой минимальный фреймворк (Router, View, Database) для простоты деплоя
- Vendor-папки нет, все зависимости встроены

### 2. Конфигурация
- Конфиг хранится в `config/config.php`
- Чувствительные данные (DB credentials) задаются через константы
- Поддержка APP_ENV (prod/dev) и APP_DEBUG (true/false)

### 3. Сессии
- Используются стандартные PHP сессии
- Session cookie: HttpOnly, SameSite=Strict
- Session lifetime: 24 часа по умолчанию

### 4. Аутентификация
- Password hashing: `password_hash()` с PASSWORD_DEFAULT (bcrypt)
- Ограничение попыток входа: 5 попыток за 15 минут
- Принудительная смена пароля: при первом входе (must_change_password flag)

### 5. CSRF Protection
- Токен генерируется для каждой сессии
- Проверяется на всех POST запросах
- Токен передается через hidden input `_csrf_token`

## Бизнес-логика допущения

### 6. Стоимость материалов
- Метод расчета: **AVG (средневзвешенная)** по умолчанию
- FIFO может быть добавлен позже как опция

### 7. Overhead (накладные расходы)
- Расчет как **процент от прямых затрат** (по умолчанию 15%)
- Отдельная настройка для каждой категории может быть добавлена позже

### 8. Учет времени операций
- **Не учитывается в MVP**
- Поля для времени заложены в структуру для будущего расширения

### 9. Склады и локации
- **Один склад** в MVP
- Структура БД позволяет добавить multi-warehouse позже
- Локации (полки/ячейки) не реализованы в MVP

### 10. Валюта
- Единая валюта: **гривна (₴)**
- Мультивалютность не предусмотрена в MVP

### 11. Единицы измерения
- Базовые: штуки (pcs), граммы (g), метры (m), комплекты (set)
- Конвертация единиц не реализована в MVP

### 12. Права и роли
- Предустановленные роли: Admin, Manager, Accountant, Worker, Viewer
- Admin имеет полный доступ без ограничений
- Роли статичны, гранулярные permissions настраиваемы

### 13. Workflow статусы
- Документы: Draft → Posted → Cancelled
- BOM/Routing ревизии: Draft → Active → Archived
- Print Jobs: Pending → In Progress → Completed → Cancelled
- Production Orders: Draft → In Progress → Completed → Cancelled

### 14. Backups
- Хранятся локально в `storage/backups/`
- Автоматическое удаление старых бэкапов не реализовано в MVP
- Scheduled backups не реализованы (только manual)

### 15. Логирование
- Единый лог файл: `storage/logs/app.log`
- Rotation логов: не реализована в MVP (рекомендуется logrotate на сервере)
- Уровни: DEBUG, INFO, WARNING, ERROR, CRITICAL

## UI/UX допущения

### 16. Интерфейс
- Server-side rendering (PHP templates)
- Минимальный JavaScript для интерактивности
- CSS framework: собственные стили (простой responsive дизайн)

### 17. Пагинация
- По умолчанию: 25 записей на страницу
- Максимум: 100 записей на страницу

### 18. Поиск
- Простой поиск по ключевым полям (name, sku, code)
- Full-text search не реализован в MVP

### 19. Язык интерфейса
- **Английский** как основной язык UI
- Мультиязычность не предусмотрена в MVP

## Безопасность допущения

### 20. Доступ к debug
- `/health/details` и `/admin/diagnostics` требуют:
  - Авторизованный пользователь с ролью Admin
  - APP_DEBUG=true в конфиге

### 21. File uploads
- Разрешенные типы: jpg, jpeg, png, gif, pdf, doc, docx, xls, xlsx
- Максимальный размер: 10MB
- Хранение: `public/uploads/` с организацией по датам

### 22. SQL Injection
- Все запросы через PDO prepared statements
- Никаких прямых вставок пользовательских данных в SQL

---

*Документ обновляется по мере выявления новых допущений в процессе разработки.*
